<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>tipos expresivos</title>
  <style>
    html {
      scroll-behavior: smooth;
    }
    body {
      margin: 0;
      font-family: Arial, Helvetica, sans-serif;
      background-color: #eeeeee;
      user-select: none;
    }

    /* Sección de inicio */
    #inicio {
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      height: 100vh;
      padding-top: 170px;  /* distancia desde arriba */
      background-color: #eeeeee;
    }

    .logo-grande {
      width: 600px;
      height: auto;
      margin-bottom: 20px;
    }

    .comenzar-btn {
      margin-top: 20px;
      padding: 10px 20px;
      font-size: 17px;
      background-color: #c7c7c7;
      color: rgb(35, 35, 35);
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }

    .comenzar-btn:hover {
      background-color: #8d8d8d;
    }

    /* Sección de juego */
    #juego {
      position: relative;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
      display: flex; /* Usaremos flexbox para la disposición general */
      align-items: center; /* Centrar verticalmente los elementos */
    }

    .encabezado {
      position: absolute;
      top: 30px;
      left: 30px;
      text-align: left;
    }

    .encabezado h1 {
      margin: 0;
      font-size: 20px;
      letter-spacing: 1px;
      text-transform: uppercase;
      color: #4f46e5;
    }

    .encabezado p {
      margin: 8px 0 0;
      font-size: 14px;
      color: rgba(79, 70, 229, 0.7);
      max-width: 300px;
    }

    .logo-animado {
      position: absolute;
      top: 20px;
      right: 20px;
      width: 160px;
      height: auto;
      pointer-events: none;
    }

    /* Tipografías */
    @import url('https://fonts.googleapis.com/css2?family=Space+Mono&display=swap');
    @import url('https://fonts.googleapis.com/css2?family=Playfair+Display&display=swap');
    @import url('https://fonts.googleapis.com/css2?family=Merriweather&display=swap');
    @import url('https://fonts.googleapis.com/css2?family=DM+Sans&display=swap');
    @import url('https://fonts.googleapis.com/css2?family=Titillium+Web&display=swap');
    @import url('https://fonts.googleapis.com/css2?family=Outfit&display=swap');
    @import url('https://fonts.googleapis.com/css2?family=Jost&display=swap');
    @import url('https://fonts.googleapis.com/css2?family=Libre+Baskerville&display=swap');

    .font-SpaceMono { font-family: 'Space Mono', monospace; }
    .font-Playfair { font-family: 'Playfair Display', serif; }
    .font-Merriweather { font-family: 'Merriweather', serif; }
    .font-DMSans { font-family: 'DM Sans', sans-serif; }
    .font-Titillium { font-family: 'Titillium Web', sans-serif; }
    .font-Outfit { font-family: 'Outfit', sans-serif; }
    .font-Jost { font-family: 'Jost', sans-serif; }
    .font-LibreBaskerville { font-family: 'Libre Baskerville', serif; }

    #contenedorTitulos {
      position: absolute; /* Posicionamiento absoluto dentro de #juego */
      top: 50%; /* Centrar verticalmente el contenedor */
      right: 5%; /* Margen desde la derecha */
      transform: translateY(-50%); /* Ajuste fino del centrado vertical */
      display: grid; /* Usaremos grid para las dos columnas */
      grid-template-columns: repeat(2, 1fr); /* Dos columnas de igual ancho */
      gap: 20px; /* Espacio entre los bloques de tipografía */
      width: auto; /* Ajustar el ancho al contenido */
    }

    .titulo {
      font-size: 20px; /* Ajustar el tamaño de la fuente si es necesario */
      background: rgba(255, 255, 255, 0.8);
      padding: 10px 15px; /* Ajustar el padding para el tamaño del bloque */
      border-radius: 8px;
      pointer-events: none;
      transition: transform 0.3s ease, background-color 0.3s ease;
      text-align: center; /* Centrar el texto dentro del bloque */
    }

    #boton {
      position: absolute;
      left: 25%; /* Colocar el botón a la izquierda (ajusta según necesites) */
      top: 50%;
      transform: translate(-50%, -50%); /* Centrar el botón */
      padding: 20px 40px;
      font-size: 28px;
      background-color: #c7c7c7;
      color: rgb(35, 35, 35);
      border: none;
      border-radius: 10px;
      cursor: grab;
      transition: box-shadow 0.2s ease, transform 0.2s ease;
    }
    #boton:active {
      cursor: grabbing;
      box-shadow: 0 0 20px rgba(0,0,0,0.3);
      transform: translate(-50%, -50%) scale(1.05);
    }
  </style>
</head>
<body>

<section id="inicio">
  <img src="tipos_expresivos_logo.png" alt="Logo Tipos Expresivos" class="logo-grande">
</section>

<section id="explicacion" style="padding: 60px 20px; background-color: #f5f5f5; display: flex; align-items: center; justify-content: center;">
  <div style="max-width: 1200px; width: 100%; display: flex; justify-content: space-between; align-items: flex-start;">
    <div style="flex: 1; text-align: left;">
      <h2 style="font-size: 32px; color: #4f46e5">¿Cómo funciona el test?</h2>
      <p style="max-width: 600px; margin: 20px auto; font-size: 18px; color: #555;">
        Este test consiste en arrastrar palabras hacia las tipografías que creas que les corresponden. Al hacer clic en el botón, se inicia el test. Cuando termines de clasificar todas las palabras, tus respuestas serán enviadas de forma anónima para análisis. ¡Gracias por participar!
      </p>
    </div>

    <div style="flex: 1; display: flex; justify-content: flex-end;">
      <img src="tipos_expresivos_logo.png" alt="Explicación del Test" style="max-width: 500px; margin-top: 20px; border-radius: 12px;" />
    </div>
  </div>
</section>

<section id="datos" style="padding: 100px 40px; background-color: #eeeeee; display: flex; justify-content: center; align-items: center;">
  <div style="max-width: 500px; width: 100%; text-align: left;">
    <h2 style="font-size: 32px; color: #4f46e5; margin-bottom: 30px; margin-top: 50px;">Ingresa tus datos</h2>

    <div style="width: 100%; display: flex; justify-content: space-between; gap: 40px;">
      <div style="flex: 1;">
        <label for="edad" style="font-size: 18px; color: #333; display: block;">Edad</label>
        <input type="text" id="edad" name="edad" placeholder="Ingresa tu edad" style="width: 100%; padding: 10px; font-size: 16px; border: 2px solid #ccc; border-radius: 8px; margin-top: 8px;">
      </div>

      <div style="flex: 1;">
        <label for="comuna" style="font-size: 18px; color: #333; display: block;">Comuna</label>
        <input type="text" id="comuna" name="comuna" placeholder="Ingresa tu comuna" style="width: 100%; padding: 10px; font-size: 16px; border: 2px solid #ccc; border-radius: 8px; margin-top: 8px;">
      </div>
    </div>
  </div>
</section>

<section id="juego" style="background-color:#f5f5f5;">
  <div class="encabezado">
    <h1>¿DÓNDE VA CADA PALABRA?</h1>
    <p>Arrastra la palabra central a la tipografía que creas correspondiente</p>
  </div>

  <img src="tipos_expresivos_logo.png" alt="Logo Tipos Expresivos" class="logo-animado" id="logoExpresivo">

  <div id="contenedorTitulos"></div>

  <button id="boton">Haz click</button>
</section>


<script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-firestore-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyB8xKvj_y33Pz7u_RRGCqRSccenQxXUNDQ",
    authDomain: "tipos-interactivos.firebaseapp.com",
    projectId: "tipos-interactivos",
    storageBucket: "tipos-interactivos.firebasestorage.app",
    messagingSenderId: "936693486771",
    appId: "1:936693486771:web:c243189625f7d18cd90cc6",
    measurementId: "G-ZXBZTMRWNJ"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const palabras = [
    "Administración", "Funcionario", "Autoridad", "Representante", "Institución",
    "Empleo", "Ciudadanía", "Derechos Humanos", "Equidad", "Diversidad",
    "Orden Público", "Delito", "Sostenibilidad", "Cambio Climático", "Tecnología"
  ];

  const tipografias = [
    { nombre: "Space Mono", clase: "font-SpaceMono" },
    { nombre: "Playfair Display", clase: "font-Playfair" },
    { nombre: "Merriweather", clase: "font-Merriweather" },
    { nombre: "DM Sans", clase: "font-DMSans" },
    { nombre: "Titillium Web", clase: "font-Titillium" },
    { nombre: "Outfit", clase: "font-Outfit" },
    { nombre: "Jost", clase: "font-Jost" },
    { nombre: "Libre Baskerville", clase: "font-LibreBaskerville" }
  ];

  let index = 0;
  const boton = document.getElementById('boton');
  const logo = document.getElementById('logoExpresivo');
  let offsetX = 0, offsetY = 0, isDragging = false;

  function nuevaPalabra() {
    boton.innerText = palabras[index % palabras.length];
    index++;
  }

  function colocarTitulos() {
    const contenedor = document.getElementById('contenedorTitulos');
    contenedor.innerHTML = ''; // Limpiar antes de añadir

    tipografias.forEach(tipografia => {
      const title = document.createElement('div');
      title.className = `titulo ${tipografia.clase}`;
      title.innerText = tipografia.nombre;
      contenedor.appendChild(title);
    });
  }

  function enviarAFirebase(palabra, tipografia) {
    db.collection("respuestas").add({
      palabra: palabra,
      tipografia: tipografia,
      fecha: new Date()
    }).then(docRef => {
      console.log("✔️ Enviado a Firestore con ID:", docRef.id);
    }).catch(error => {
      console.error("❌ Error al guardar:", error);
    });
  }

  function actualizarResumenEnFirestore(palabra, tipografia) {
    const docRef = db.collection("resumenRespuestas").doc(palabra);
    docRef.get().then((doc) => {
      if (doc.exists) {
        const data = doc.data();
        const actuales = data.tipografias || {};
        const nuevoTotal = (actuales[tipografia] || 0) + 1;
        docRef.update({
          [`tipografias.${tipografia}`]: nuevoTotal
        });
      } else {
        docRef.set({ tipografias: { [tipografia]: 1 } });
      }
    });
  }

  function detectarColision() {
    const botonRect = boton.getBoundingClientRect();
    document.querySelectorAll('.titulo').forEach(titulo => {
      const tituloRect = titulo.getBoundingClientRect();
      const dx = (botonRect.left + botonRect.width / 2) - (tituloRect.left + tituloRect.width / 2);
      const dy = (botonRect.top + botonRect.height / 2) - (tituloRect.top + tituloRect.height / 2);
      const distancia = Math.sqrt(dx * dx + dy * dy);

      if (distancia < 70) { // Ajusta la distancia de colisión si es necesario
        titulo.style.transform = 'scale(1.2)';
        titulo.style.backgroundColor = '#4f46e5';
        titulo.style.color = '#fff';

        const palabra = boton.innerText;
        const tipografia = titulo.innerText;

        enviarAFirebase(palabra, tipografia);
        actualizarResumenEnFirestore(palabra, tipografia);

        setTimeout(() => {
          titulo.style.transform = '';
          titulo.style.backgroundColor = '';
          titulo.style.color = '';
          resetBoton();
          nuevaPalabra();
        }, 500);
      }
    });
  }

  function resetBoton() {
    boton.style.left = '25%';
    boton.style.top = '50%';
    boton.style.transform = 'translate(-50%, -50%)';
  }

  document.addEventListener('mousemove', e => {
    const logoRect = logo.getBoundingClientRect();
    const distancia = Math.hypot(
      e.clientX - (logoRect.left + logoRect.width / 2),
      e.clientY - (logoRect.top + logoRect.height / 2)
    );

    logo.style.transform = distancia < 150 ? 'scale(1.1) rotate(2deg)' : 'scale(1) rotate(0deg)';

    if (isDragging) {
      boton.style.left = `${e.clientX - offsetX}px`;
      boton.style.top = `${e.clientY - offsetY}px`;
    }
  });

  boton.addEventListener('mousedown', e => {
    isDragging = true;
    offsetX = e.clientX - boton.offsetLeft;
    offsetY = e.clientY - boton.offsetTop;
    boton.style.transition = "none";
  });

  document.addEventListener('mouseup', () => {
    if (isDragging) {
      isDragging = false;
      boton.style.transition = "left 0.2s ease, top 0.2s ease";
      detectarColision();
    }
  });

  nuevaPalabra();
  colocarTitulos();
</script>
</body>
</html>